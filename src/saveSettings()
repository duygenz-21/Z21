function saveSettings() {
    config.apiKey = document.getElementById('apiKeyInput').value.trim();
    config.customUrl = document.getElementById('customUrlInput').value.trim();
    config.systemPrompt = document.getElementById('systemPromptInput').value.trim();
    config.temperature = parseFloat(document.getElementById('tempInput').value);
    
    const topPVal = document.getElementById('topPInput').value;
    config.topP = parseFloat(topPVal);
    localStorage.setItem('chat_top_p', config.topP);
    localStorage.setItem('chat_api_key', config.apiKey);
    localStorage.setItem('chat_custom_url', config.customUrl);         
    localStorage.setItem('chat_models_list', JSON.stringify(config.models));
    localStorage.setItem('chat_temperature', config.temperature);
    
    config.visionModel = document.getElementById('visionModelInput').value.trim();
    localStorage.setItem('chat_use_vision', config.useVision);
    localStorage.setItem('chat_vision_model', config.visionModel);
 
    chatHistory[0].content = config.systemPrompt;
    renderHeaderStatus();
    closeSettings();
}